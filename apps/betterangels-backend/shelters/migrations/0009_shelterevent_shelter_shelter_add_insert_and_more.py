# Generated by Django 5.0.7 on 2024-08-06 18:11

import django.core.validators
import django.db.models.deletion
import django_ckeditor_5.fields
import pgtrigger.compiler
import pgtrigger.migrations
import phonenumber_field.modelfields
from django.db import migrations, models


class Migration(migrations.Migration):

    dependencies = [
        ("common", "0014_address_confidential_attachment_mime_type_and_more"),
        ("organizations", "0006_alter_organization_slug"),
        ("pghistory", "0006_delete_aggregateevent"),
        ("shelters", "0008_alter_funder_name_alter_population_name_and_more"),
    ]

    operations = [
        migrations.CreateModel(
            name="ShelterEvent",
            fields=[
                ("pgh_id", models.AutoField(primary_key=True, serialize=False)),
                ("pgh_created_at", models.DateTimeField(auto_now_add=True)),
                ("pgh_label", models.TextField(help_text="The event label.")),
                ("id", models.IntegerField()),
                ("created_at", models.DateTimeField(auto_now_add=True)),
                ("updated_at", models.DateTimeField(auto_now=True)),
                ("name", models.CharField(max_length=255)),
                ("email", models.EmailField(blank=True, max_length=254, null=True)),
                ("phone", phonenumber_field.modelfields.PhoneNumberField(max_length=128, region=None)),
                ("website", models.URLField(blank=True, null=True)),
                ("description", django_ckeditor_5.fields.CKEditor5Field(null=True)),
                ("how_to_enter", django_ckeditor_5.fields.CKEditor5Field(blank=True, null=True)),
                ("mandatory_worship_attendance", models.BooleanField(blank=True, null=True)),
                (
                    "city_district",
                    models.PositiveSmallIntegerField(
                        blank=True,
                        null=True,
                        validators=[
                            django.core.validators.MinValueValidator(1),
                            django.core.validators.MaxValueValidator(15),
                        ],
                        verbose_name="LA City Council District (1-15)",
                    ),
                ),
                (
                    "supervisorial_district",
                    models.PositiveSmallIntegerField(
                        blank=True,
                        null=True,
                        validators=[
                            django.core.validators.MinValueValidator(1),
                            django.core.validators.MaxValueValidator(5),
                        ],
                        verbose_name="Supervisorial District (1-5)",
                    ),
                ),
                ("curfew", models.TimeField(blank=True, null=True)),
                ("max_stay", models.PositiveIntegerField(blank=True, null=True, verbose_name="Max Stay (days)")),
                ("security", models.BooleanField(blank=True, null=True)),
                ("drugs", models.BooleanField(blank=True, null=True)),
                ("program_fees", models.BooleanField(blank=True, null=True)),
                ("fees", django_ckeditor_5.fields.CKEditor5Field(blank=True, null=True)),
                ("total_beds", models.PositiveIntegerField(blank=True, null=True)),
                ("is_reviewed", models.BooleanField(default=False)),
            ],
            options={
                "abstract": False,
            },
        ),
        pgtrigger.migrations.AddTrigger(
            model_name="shelter",
            trigger=pgtrigger.compiler.Trigger(
                name="shelter_add_insert",
                sql=pgtrigger.compiler.UpsertTriggerSql(
                    func='INSERT INTO "shelters_shelterevent" ("address_id", "city_district", "created_at", "curfew", "description", "drugs", "email", "fees", "how_to_enter", "id", "is_reviewed", "mandatory_worship_attendance", "max_stay", "name", "organization_id", "pgh_context_id", "pgh_created_at", "pgh_label", "pgh_obj_id", "phone", "program_fees", "security", "supervisorial_district", "total_beds", "updated_at", "website") VALUES (NEW."address_id", NEW."city_district", NEW."created_at", NEW."curfew", NEW."description", NEW."drugs", NEW."email", NEW."fees", NEW."how_to_enter", NEW."id", NEW."is_reviewed", NEW."mandatory_worship_attendance", NEW."max_stay", NEW."name", NEW."organization_id", _pgh_attach_context(), NOW(), \'shelter.add\', NEW."id", NEW."phone", NEW."program_fees", NEW."security", NEW."supervisorial_district", NEW."total_beds", NEW."updated_at", NEW."website"); RETURN NULL;',
                    hash="715c0b0fbe8ababd5270683927fc1ed62e1b8bf6",
                    operation="INSERT",
                    pgid="pgtrigger_shelter_add_insert_6bdb6",
                    table="shelters_shelter",
                    when="AFTER",
                ),
            ),
        ),
        pgtrigger.migrations.AddTrigger(
            model_name="shelter",
            trigger=pgtrigger.compiler.Trigger(
                name="shelter_update_update",
                sql=pgtrigger.compiler.UpsertTriggerSql(
                    condition="WHEN (OLD.* IS DISTINCT FROM NEW.*)",
                    func='INSERT INTO "shelters_shelterevent" ("address_id", "city_district", "created_at", "curfew", "description", "drugs", "email", "fees", "how_to_enter", "id", "is_reviewed", "mandatory_worship_attendance", "max_stay", "name", "organization_id", "pgh_context_id", "pgh_created_at", "pgh_label", "pgh_obj_id", "phone", "program_fees", "security", "supervisorial_district", "total_beds", "updated_at", "website") VALUES (NEW."address_id", NEW."city_district", NEW."created_at", NEW."curfew", NEW."description", NEW."drugs", NEW."email", NEW."fees", NEW."how_to_enter", NEW."id", NEW."is_reviewed", NEW."mandatory_worship_attendance", NEW."max_stay", NEW."name", NEW."organization_id", _pgh_attach_context(), NOW(), \'shelter.update\', NEW."id", NEW."phone", NEW."program_fees", NEW."security", NEW."supervisorial_district", NEW."total_beds", NEW."updated_at", NEW."website"); RETURN NULL;',
                    hash="3247c7dbc1ecb3f26fa9778fb47a75d9100bd174",
                    operation="UPDATE",
                    pgid="pgtrigger_shelter_update_update_086d2",
                    table="shelters_shelter",
                    when="AFTER",
                ),
            ),
        ),
        pgtrigger.migrations.AddTrigger(
            model_name="shelter",
            trigger=pgtrigger.compiler.Trigger(
                name="shelter_remove_delete",
                sql=pgtrigger.compiler.UpsertTriggerSql(
                    func='INSERT INTO "shelters_shelterevent" ("address_id", "city_district", "created_at", "curfew", "description", "drugs", "email", "fees", "how_to_enter", "id", "is_reviewed", "mandatory_worship_attendance", "max_stay", "name", "organization_id", "pgh_context_id", "pgh_created_at", "pgh_label", "pgh_obj_id", "phone", "program_fees", "security", "supervisorial_district", "total_beds", "updated_at", "website") VALUES (OLD."address_id", OLD."city_district", OLD."created_at", OLD."curfew", OLD."description", OLD."drugs", OLD."email", OLD."fees", OLD."how_to_enter", OLD."id", OLD."is_reviewed", OLD."mandatory_worship_attendance", OLD."max_stay", OLD."name", OLD."organization_id", _pgh_attach_context(), NOW(), \'shelter.remove\', OLD."id", OLD."phone", OLD."program_fees", OLD."security", OLD."supervisorial_district", OLD."total_beds", OLD."updated_at", OLD."website"); RETURN NULL;',
                    hash="b2d79b22ae13b34e9c7d6111535d4edc328d741a",
                    operation="DELETE",
                    pgid="pgtrigger_shelter_remove_delete_928d6",
                    table="shelters_shelter",
                    when="AFTER",
                ),
            ),
        ),
        migrations.AddField(
            model_name="shelterevent",
            name="address",
            field=models.ForeignKey(
                blank=True,
                db_constraint=False,
                null=True,
                on_delete=django.db.models.deletion.DO_NOTHING,
                related_name="+",
                related_query_name="+",
                to="common.address",
            ),
        ),
        migrations.AddField(
            model_name="shelterevent",
            name="organization",
            field=models.ForeignKey(
                blank=True,
                db_constraint=False,
                null=True,
                on_delete=django.db.models.deletion.DO_NOTHING,
                related_name="+",
                related_query_name="+",
                to="organizations.organization",
            ),
        ),
        migrations.AddField(
            model_name="shelterevent",
            name="pgh_context",
            field=models.ForeignKey(
                db_constraint=False,
                null=True,
                on_delete=django.db.models.deletion.DO_NOTHING,
                related_name="+",
                to="pghistory.context",
            ),
        ),
        migrations.AddField(
            model_name="shelterevent",
            name="pgh_obj",
            field=models.ForeignKey(
                db_constraint=False,
                on_delete=django.db.models.deletion.DO_NOTHING,
                related_name="events",
                to="shelters.shelter",
            ),
        ),
    ]
