appId: la.betterangels.dev.app
platform: ${MAESTRO_PLATFORM}
---
- openLink: betterangels-dev://expo-development-client/?url=https://u.expo.dev/${MAESTRO_PROJECT_ID}/group/${MAESTRO_GROUP_ID}?platform=${MAESTRO_PLATFORM}%26disableOnboarding%3D1

- runFlow:
    when:
      visible: 'There was a problem loading'
    commands:
      - repeat:
          times: 10
          commands:
            - takeScreenshot: error-restart-kill
            - killApp: la.betterangels.dev.app
            - waitForAnimationToEnd
            - openLink: betterangels-dev://expo-development-client/?url=https://u.expo.dev/${MAESTRO_PROJECT_ID}/group/${MAESTRO_GROUP_ID}?platform=${MAESTRO_PLATFORM}%26disableOnboarding%3D1
            - waitForAnimationToEnd
            - extendedWaitUntil:
                visible: 'Better Angels'
                timeout: 5000
                optional: true

- runFlow:
    when:
      platform: ios
      visible: 'Open'
    commands:
      - tapOn: 'Open'

- assertVisible: 'Better Angels'
- assertVisible: 'HMIS'
- tapOn:
    id: 'better-angels-login'
- assertVisible: 'Welcome!'
